{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "constraintsModule": {
      "type": "array",
      "items": {
        "enum": [
          "floor area",
          "FAR",
          "floor width",
          "lot area",
          "lot width",
          "footprint",
          "height",
          "stories",
          "story floors",
          "lot coverage",
          "allowed uses",
          "district",
          "setbacks"
        ]
      },
      "minItems": 1
    },
    "dynamicConstraintProperties": {
      "type": "object",
      "anyOf": [
        { "$ref": "schema_constraints module.json#/definitions/maximum" },
        { "$ref": "schema_constraints module.json#/definitions/minimum" },
        { "$ref": "schema_constraints module.json#/definitions/height" },
        { "$ref": "schema_constraints module.json#/definitions/FAR" },
        { "$ref": "schema_constraints module.json#/definitions/floorArea" },
        { "$ref": "schema_constraints module.json#/definitions/floorWidth" },
        { "$ref": "schema_constraints module.json#/definitions/lotArea" },
        { "$ref": "schema_constraints module.json#/definitions/lotWidth" },
        { "$ref": "schema_constraints module.json#/definitions/footprint" },
        { "$ref": "schema_constraints module.json#/definitions/stories" },
        { "$ref": "schema_constraints module.json#/definitions/storyFloors" },
        { "$ref": "schema_constraints module.json#/definitions/setbacks" },
        { "$ref": "schema_constraints module.json#/definitions/lotCoverage" },
        { "$ref": "schema_constraints module.json#/definitions/allowedUses" }
      ]
    },
    "lot": {
      "type": "object",
      "properties": {
        "districtTypeGroups": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "districts": {
                "type": "array",
                "items": {
                  "$comment": "Replace with actual district values",
                  "enum": ["district1", "district2"]
                }
              }
            },
            "additionalProperties": {
              "anyOf": [
                { "$ref": "#/properties/dynamicConstraintProperties" },
                { "type": "object", "additionalProperties": false }
              ]
            }
          }
        },
        "developmentOptionality": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "developmentType": {
                "enum": ["primary", "accessory"]
              },
              "primaryStructures": {
                "type": "object",
                "properties": {
                  "bulkOptionality": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "bulks": {
                          "type": "array",
                          "items": {
                            "enum": [
                              "single-family",
                              "two-family",
                              "three-family",
                              "multi-family"
                            ]
                          }
                        }
                      },
                      "additionalProperties": {
                        "anyOf": [
                          {
                            "$ref": "#/properties/dynamicConstraintProperties"
                          },
                          { "type": "object", "additionalProperties": false }
                        ]
                      }
                    }
                  }
                }
              },
              "accessoryStructures": {
                "type": "object",
                "properties": {
                  "ADbulkOptionality": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "ADbulks": {
                          "type": "array",
                          "items": {
                            "enum": ["ADU", "garage"]
                          }
                        }
                      },
                      "additionalProperties": {
                        "anyOf": [
                          {
                            "$ref": "#/properties/dynamicConstraintProperties"
                          },
                          { "type": "object", "additionalProperties": false }
                        ]
                      }
                    }
                  },
                  "ADtypeOptionality": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "ADtype": {
                          "type": "array",
                          "items": {
                            "enum": ["interior", "attached", "detached"]
                          }
                        }
                      },
                      "additionalProperties": {
                        "anyOf": [
                          {
                            "$ref": "#/properties/dynamicConstraintProperties"
                          },
                          { "type": "object", "additionalProperties": false }
                        ]
                      }
                    }
                  },
                  "bulkOptionality": {
                    "$ref": "#/properties/lot/properties/developmentOptionality/items/properties/primaryStructures/properties/bulkOptionality"
                  }
                }
              }
            }
          }
        }
      },

      "additionalProperties": false
    }
  },
  "required": ["constraintsModule"]
}
